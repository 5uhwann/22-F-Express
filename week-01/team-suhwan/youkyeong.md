# ~ Section4

# Node.js

### 개념

- JavaScript 런타임으로 평범한 브라우저, 서버 및 어떤 기기에서도 js코드를 실행할 수 있게 도움
- 다른 버전의 javascript으로서 javascript를 기반으로 하였으나 기존의 기능 중 일부는 빠지고 일부는 더하여, 다른 환경에서 javascript를 구현한 것이라 이해 가능
- V8(구글에서 개발한 js엔진으로 js를 브라우저에서 실행)사용하여 컴파일 (js코드 → 머신코드)

### 특성

- variable을 전역으로 노출시킴
- 서버 사이드 기술
- 하나의 JS thread만 사용

<aside>
💡 thread : 운영체제의 프로세스

</aside>

### 서버 구축 코드 해석

```jsx
const http=require('http');//Node.js에 탑재된 글로벌 모듈 http

const server=http.createServer((req,res)=>{//요청을 실행하는 server객체
//응답 공간
    console.log(res);
//
});

server.listen(3000);//server가 실행 직후, 꺼지지 않고 계속 실행되도록
```

### Life Cycle

1. 파일 실행
2. 코드 분석 이후 변수와 함수 등록
3. 이벤트 루프 → 이벤트리스너가 있는 경우에 한하여 작동하는 loop process
4. process.exit을 통한 실행 중지(createServe가 절대 끝나지 않는 이벤트에 대한 이벤트 리스너를 등록하므로 서버는 끝나지 않음)

# 요청의 처리

### : 스트림 → 처리 → 파싱완료

### 스트림

- 지속적인 프로세스

### 처리

- node는 요청을 한 청크씩 읽음
- 요청을 끝까지 읽지 않아도, 읽힌 각각의 청크를 다룰 수 있음 → 코드를 사용하여 청크를 다루는 것은 불가능
- 체계화를 위해 Buffer를 이용

<aside>
💡 Buffer
- 여러개의 청크를 보유
- 파싱 이전에 작업할 수 있도록 함

</aside>

### 비동기 처리

- 응답 발송은 이벤트 리스너 실행이 끝났다는 의미가 아님→ 응답이 발송된 후에도 이벤트 리스너는 계속 실행될 수 있기때문에 이벤트 리스너 응답에 영향을 줄 수 있는 설정은 지양
- 함수 내부에 함수를 넣으면 내부에 들어간 함수를 나중에 실행하는 경우가 많음 → 비동기식
- 위 경우 내부적으로 이벤트 리스너를 하나 추가하여 이벤트 이미터에 등록, end이벤트 발송이전에 등록했던 이벤트(들)을 처리
- 모든 동기화 코드를 전부 실행한 이후에, 비동기 코드를 실행

# 연산자

## Spread연산자

: 배열이나 객체에서 원소나 속성을 추출하는데 사용

### 방식

- 배열명.slice()
- […배열명] : 배열의 원소나 속성을 꺼내어 새 배열에 추가하는 방식으로 배열 뿐만아니라 객체에도 적용 가능

## Rest연산자

: 여러 인수를 하나의 배열로 묶는데 사용

### 방식

```jsx
const apple=(…something)⇒ {//something은 any text 가능
 return something; //인자의 개수와 무관하게 배열 반환
};
```

# 이벤트루프

: Node.js에 의해 실행되어 Node.js를 계속 실행되도록 하는 루프로 모든 콜백을 처리

### Timer

: 루핑을 계속하는 루프, 새로운 반복이 시작 될 때마다 실행해야하는 타이머 콜백이 있는지 확인 (setTimeOut과 setInterval)

### Pending Callbacks

: 파일 및 네트워크 연산 등 블로킹 연산을 처리

Node.js가 떠나는 시점에, 남은 callback이 너무 많다면 루프반복을 이어가는 대신 남은 콜백을 다음 반복에서 실행하게 미뤄 열린 콜백을 모두 처리

### poll

: Node.js가 새로운 I/O 이벤트를 찾아서 최대한 빨리 실행하도록 하지만 불가능한 경우에는 실행을 미루고 대기콜백으로 등록
: 타이머가 다 되어 실행해야하는 콜백이 존재하는 경우, 반복을 이어가지 않고 Timer단계로 넘어가 바로 실행하여 다시 돌아가는 것이 가능

### check

: setImmediate콜백이 실행. 
setTimeOut과 setInterval처럼 바로 실행은 되지만 반드시 열린 콜백이 모두 실행 된 이후에 실행

### close callbacks

→ : 닫힌 이벤트 콜백 모두 실행, 별도로 처리


→ 등록한 이벤트 핸들러가 남았는지 확인
→ 프로그램 종료

# 기타

- REPL(Read, Eval, Print, Loop)
- on(’특정 event’, ‘이벤트에 실행될 함수’) : 특정 이벤트를 들을 수 있게하는 method